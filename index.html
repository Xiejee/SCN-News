<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCN - Songhe Class News</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #1a73e8;
            --accent: #00d2ff;
            --bg: #f8fafc;
            --card: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --ease: cubic-bezier(0.4, 0, 0.2, 1);
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg);
            margin: 0; color: var(--text-main);
            overflow-x: hidden;
        }

        /* --- 顶栏 UI --- */
        .navbar {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            padding: 12px 5%;
            display: flex; align-items: center; justify-content: space-between;
            position: sticky; top: 0; z-index: 100;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .search-container {
            flex: 1; max-width: 400px; margin: 0 20px;
            position: relative;
        }

        .search-input {
            width: 100%; padding: 10px 15px 10px 40px;
            border-radius: 12px; border: 1.5px solid #e2e8f0;
            background: #f1f5f9; transition: all 0.3s; outline: none;
        }

        .search-input:focus {
            background: #fff; border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(26, 115, 232, 0.1);
        }

        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-sub); }

        .nav-btn {
            background: none; border: none; font-size: 1.4rem; cursor: pointer;
            color: var(--text-sub); transition: 0.3s; width: 40px; height: 40px;
            border-radius: 10px; display: flex; align-items: center; justify-content: center;
        }

        .nav-btn:hover { background: #eff6ff; color: var(--primary); }

        /* --- 视图管理 --- */
        .view {
            display: none; max-width: 800px; margin: 30px auto; padding: 0 20px;
            animation: viewShow 0.5s var(--ease) forwards;
        }

        @keyframes viewShow {
            from { opacity: 0; transform: translateY(15px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .view.active { display: block; }

        /* --- 列表页卡片 --- */
        .news-item {
            background: var(--card); border-radius: 16px; padding: 20px;
            margin-bottom: 16px; cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            transition: all 0.3s var(--ease);
            border: 1px solid transparent;
            display: flex; justify-content: space-between; align-items: center;
        }

        .news-item:hover {
            transform: scale(1.02); border-color: var(--primary);
            box-shadow: var(--shadow);
        }

        .news-info h3 { margin: 0 0 8px 0; font-size: 1.2rem; color: var(--primary); }
        .news-info p { margin: 0; font-size: 0.85rem; color: var(--text-sub); }
        .ri-arrow-right-s-line { color: #cbd5e1; font-size: 1.5rem; }

        /* --- 详情页内容 --- */
        .detail-header { border-bottom: 2px solid #f1f5f9; padding-bottom: 20px; margin-bottom: 25px; }
        .back-btn { 
            display: inline-flex; align-items: center; gap: 5px; 
            color: var(--primary); cursor: pointer; font-weight: 600; margin-bottom: 15px; 
        }
        .detail-title { font-size: 2rem; margin: 10px 0; line-height: 1.3; }
        .detail-content { font-size: 1.1rem; line-height: 1.8; color: #334155; white-space: pre-wrap; }

        /* --- 设置页 UI --- */
        .settings-card { background: #fff; border-radius: 20px; padding: 30px; box-shadow: var(--shadow); }
        .set-section { margin-bottom: 30px; }
        .set-section h4 { border-left: 4px solid var(--primary); padding-left: 10px; margin-bottom: 15px; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .info-box { background: #f8fafc; padding: 15px; border-radius: 12px; }
        .info-box small { color: var(--text-sub); display: block; margin-bottom: 5px; }

        .update-log { font-size: 0.95rem; color: #475569; background: #fffbeb; padding: 15px; border-radius: 12px; border-left: 4px solid #fbbf24; }

        /* --- 状态 --- */
        .loader { text-align: center; padding: 50px; color: var(--text-sub); }
        .empty-state { text-align: center; padding: 100px 0; color: #94a3b8; }
    </style>
</head>
<body>

    <nav class="navbar">
        <div style="font-weight: 800; font-size: 1.4rem; color: var(--primary); cursor:pointer" onclick="showView('list')">SCN</div>
        
        <div class="search-container" id="searchBar">
            <i class="ri-search-line search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="搜索文章标题或内容...">
        </div>

        <button class="nav-btn" onclick="showView('settings')">
            <i class="ri-settings-4-line"></i>
        </button>
    </nav>

    <div id="view-list" class="view active">
        <div id="list-container">
            <div class="loader"><i class="ri-loader-4-line"></i> 正在同步资讯...</div>
        </div>
    </div>

    <div id="view-detail" class="view">
        <div class="back-btn" onclick="showView('list')"><i class="ri-arrow-left-line"></i> 返回列表</div>
        <div id="detail-container"></div>
    </div>

    <div id="view-settings" class="view">
        <div class="back-btn" onclick="showView('list')"><i class="ri-arrow-left-line"></i> 返回首页</div>
        <div class="settings-card">
            <div class="set-section">
                <h4><i class="ri-computer-line"></i> 关于程序</h4>
                <div class="info-grid">
                    <div class="info-box"><small>程序名称</small>SCN (Songhe Class News)</div>
                    <div class="info-box"><small>当前版本</small>2.0.0.20260118</div>
                    <div class="info-box"><small>更新时间</small>2026-01-18</div>
                    <div class="info-box"><small>开发者</small>JEEX (2428943240@qq.com)</div>
                </div>
            </div>
            <div class="set-section">
                <h4><i class="ri-history-line"></i> 更新说明 (V2.0)</h4>
                <div class="update-log">
                    • <b>列表-详情架构</b>：引入全新浏览逻辑，大幅提升信息筛选效率。<br>
                    • <b>实时搜索</b>：支持模糊匹配标题与正文关键词。<br>
                    • <b>SPA体验</b>：全页面无刷新跳转，丝滑过渡动画。<br>
                    • <b>UI升级</b>：采用毛玻璃导航栏与现代卡片阴影设计。<br>
                    • <b>独立设置页</b>：整合版本信息与开发文档。
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===========================
        // 配置区域
        // ===========================
        const CONFIG = {
            username: 'Xiejee',
            repo: 'SCN-News',
            path: 'news', 
            prefix: 'news_'
        };

        let allNews = []; // 存储所有新闻数据

        // --- 核心逻辑：视图切换 ---
        function showView(viewName) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(`view-${viewName}`).classList.add('active');
            window.scrollTo(0,0);
            
            // 列表页显示搜索框，其他页隐藏
            document.getElementById('searchBar').style.opacity = (viewName === 'list') ? '1' : '0';
            document.getElementById('searchBar').style.pointerEvents = (viewName === 'list') ? 'auto' : 'none';
        }

        // --- 获取并解析数据 ---
        async function loadData() {
            const listContainer = document.getElementById('list-container');
            try {
                let url = `https://api.github.com/repos/${CONFIG.username}/${CONFIG.repo}/contents/${CONFIG.path}`;
                if(!CONFIG.path) url = `https://api.github.com/repos/${CONFIG.username}/${CONFIG.repo}/contents/`;
                
                const res = await fetch(url);
                const files = await res.json();
                const targetFiles = files.filter(f => f.name.startsWith(CONFIG.prefix) && f.name.endsWith('.txt'));

                const promises = targetFiles.map(async file => {
                    const contentRes = await fetch(file.download_url);
                    const text = await contentRes.text();
                    const title = (text.match(/TITLE:\s*(.*)/i) || [])[1] || "无标题新闻";
                    const date = (text.match(/DATE:\s*(.*)/i) || [])[1] || "时间未知";
                    const body = text.split('---')[1] || "内容为空";
                    return { title, date, body, timestamp: new Date(date.replace(/-/g,'/')).getTime() };
                });

                allNews = (await Promise.all(promises)).filter(n => n).sort((a,b) => b.timestamp - a.timestamp);
                renderList(allNews);

            } catch (e) {
                listContainer.innerHTML = `<div class="empty-state">加载失败: ${e.message}</div>`;
            }
        }

        // --- 渲染列表 ---
        function renderList(data) {
            const container = document.getElementById('list-container');
            if(data.length === 0) {
                container.innerHTML = `<div class="empty-state">没有找到相关新闻</div>`;
                return;
            }

            container.innerHTML = data.map((news, index) => `
                <div class="news-item" onclick="showDetail(${allNews.indexOf(news)})" style="animation-delay: ${index*0.05}s">
                    <div class="news-info">
                        <h3>${news.title}</h3>
                        <p><i class="ri-calendar-event-line"></i> ${news.date}</p>
                    </div>
                    <i class="ri-arrow-right-s-line"></i>
                </div>
            `).join('');
        }

        // --- 搜索功能 ---
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const kw = e.target.value.toLowerCase();
            const filtered = allNews.filter(n => 
                n.title.toLowerCase().includes(kw) || 
                n.body.toLowerCase().includes(kw)
            );
            renderList(filtered);
        });

        // --- 详情显示 ---
        function showDetail(index) {
            const news = allNews[index];
            const container = document.getElementById('detail-container');
            container.innerHTML = `
                <div class="detail-header">
                    <h1 class="detail-title">${news.title}</h1>
                    <p style="color:var(--text-sub)"><i class="ri-time-line"></i> 发布时间：${news.date}</p>
                </div>
                <div class="detail-content">${news.body.trim()}</div>
            `;
            showView('detail');
        }

        // 初始化
        loadData();
    </script>
</body>
</html>